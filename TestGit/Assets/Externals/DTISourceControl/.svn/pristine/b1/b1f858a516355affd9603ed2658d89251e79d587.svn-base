
namespace DTI.SourceControl.ConsoleTools
{
	internal class ConsoleTool
	{
		private readonly IProcessLauncher _launcher;
		private readonly IParser _parser;

		public ConsoleTool(IProcessLauncher launcher, IParser parser)
		{
			_launcher = launcher;
			_parser = parser;
		}

		public IProcessLauncher Launcher { get { return _launcher; } }
		public IParser Parser { get { return _parser; } }

		public Result Run()
		{
			// TODO: Добавить обработку возвращаемого значения
			int retCode = _launcher.Run();
			return _parser.Parse(_launcher.OutputWriter.ToString() + _launcher.ErrorWriter.ToString());
		}
	}

	internal class ConsoleTool<T>
	{
		private readonly IProcessLauncher _launcher;
		private readonly IParser<T> _parser;

		public ConsoleTool(IProcessLauncher launcher, IParser<T> parser)
		{
			_launcher = launcher;
			_parser = parser;
		}

		public IProcessLauncher Launcher { get { return _launcher; } }
		public IParser Parser { get { return _parser; } }

		public Result<T> Run()
		{
			// TODO: Добавить обработку возвращаемого значения
			int retCode = _launcher.Run();
			return _parser.Parse(_launcher.OutputWriter.ToString() + _launcher.ErrorWriter.ToString());
		}
	}
}
